define("question:widget/ask/share/share.js",function(e,t){function i(e){var t=["toolbar=0,status=0,resizable=1,width=",e.width||440,",height=",e.height||430,",left=",(screen.width-(e.width||440))/2,",top=",(screen.height-(e.height||430))/2].join("");window.open(e.url,"shareWindow",t)||(location.href=e.url)}function o(e,t){var i={render:document.createElement("canvas").getContext?"canvas":"table",width:t.width,height:t.height,text:t.href};F.context("weixinShareTinyUrl")?(i.text=F.context("weixinShareTinyUrl"),e.qrcode(i)):n.ajax({url:"/api/gettinyurl",type:"POST",dataType:"json",data:{url:t.href}}).done(function(t){var o=t.data;0==t.errno?(F.context("weixinShareTinyUrl",o.tinyurl),i.text=o.tinyurl,e.qrcode(i)):e.qrcode(i)}).fail(function(){e.qrcode(i)})}var n=e("common:widget/js/util/tangram/tangram.js"),a=e("common:widget/js/ui/tip/tip.js"),s=e("common:widget/js/util/log/log.js");e("common:widget/js/logic/qrcode/qrcode.js"),t.init=function(e){try{if(!e.target||!e.pageUrl||!e.title)return;var t=n(e.target),r=e.pageUrl,c=-1==r.indexOf("?")?"?":"&";t.on("tooltipopen",function(t,i){n(this).addClass("tips-open"),o(i.tooltip.find(".weixin-qrcode-img"),{width:100,height:100,href:r+c+"sharesource=weixin"}),e.logOpt&&(e.logOpt.action="share-view",s.send(e.logOpt))}),t.on("tooltipclose",function(){n(this).removeClass("tips-open")}),t.on("click",".others-share-item",function(t){try{if(t.preventDefault(),n(this).hasClass("weixin"))return;var o=n(this),a={url:o.attr("href")};o.hasClass("weibo")||(a.width=800,a.height=600),i(a),e.logOpt&&(e.logOpt.action="share-click-"+o.data("type"),s.send(e.logOpt))}catch(r){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:r.message,path:"question:widget/ask/share/share.js",method:"",ln:62})}});var h={url:r+c+"sharesource=qq",title:e.title,pics:e.pic||"https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/zhidaologo.png"},l={url:r+c+"sharesource=qzone",title:e.title,pics:e.pic||"https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/zhidaologo.png"},d={url:r+c+"sharesource=weibo",title:e.weiboTitle||e.title,pic:e.pic||"https://gss0.bdstatic.com/70cFsjip0QIZ8tyhnq/img/iknow/zhidaologo.png"};e.summary&&(h.summary=e.summary,l.summary=e.summary,d.summary=e.summary);var p=[],g=[],m=[];for(var u in h)p.push(u+"="+encodeURIComponent(h[u]||""));for(var u in l)g.push(u+"="+encodeURIComponent(l[u]||""));for(var u in d)m.push(u+"="+encodeURIComponent(d[u]||""));var w="http://connect.qq.com/widget/shareqq/index.html?"+p.join("&"),f="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?"+g.join("&"),q="http://v.t.sina.com.cn/share/share.php?"+m.join("&"),v=['<div class="others-share">','<a href="javascript:void(0)" target="_blank" class="others-share-item weixin iknow-qb_share_icons" data-type="weixin-click"><span class="logo"></span></a>','<a href="'+q+'" target="_blank" class="others-share-item weibo iknow-qb_share_icons" data-type="weibo-click"><span class="logo"></span></a>','<a href="'+w+'" target="_blank" class="others-share-item qq iknow-qb_share_icons" data-type="qq-click"><span class="logo"></span></a>','<a href="'+f+'" target="_blank" class="others-share-item qzone iknow-qb_share_icons" data-type="qzone-click"><span class="logo"></span></a>',"</div>"].join("");t.html(v);var x,y,b=['<div class="weixin-container">','<div class="weixin-qrcode">','<div class="weixin-qrcode-img"></div>','<p class="weixin-qrcode-title">\u626b\u4e00\u626b\u5206\u4eab\u5230\u5fae\u4fe1</p>',"</div>",'<div class="weixin-qrcode-lead"></div>',"</div>"].join(""),k={direction:"rightSilde"==e.pos?"right":"top",tooltipClass:"wgt-common-share-tip",content:b,target:t.find(".weixin")[0],position:{my:"rightSilde"==e.pos?"left-180 top":"left top+5",at:"rightSilde"==e.pos?"left-80 bottom-45":"left-80 bottom+5"}},j=n.extend(!0,k,e.tipsOpt);t.find(".weixin").hover(function(){clearTimeout(y),(x||(x=new a(j))).show(),x.getTipContainer().hover(function(){clearTimeout(y)},function(){y=setTimeout(function(){x.hide()},100)})},function(){y=setTimeout(function(){x.hide()},100)})}catch(_){"undefined"!=typeof alog&&alog("exception.fire","catch",{msg:_.message,path:"question:widget/ask/share/share.js",method:"",ln:152})}}});